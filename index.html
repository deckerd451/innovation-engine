<!DOCTYPE html>
<html lang="en-US">
<head>
  <!-- Neuron redirect -->
  <script>
    const params = new URLSearchParams(window.location.search);
    if (params.get("source") === "neuron") {
      window.location.href = "/neural.html?" + params.toString();
    }
  </script>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-6NDKG07DY6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag("js", new Date());
    gtag("config", "G-6NDKG07DY6");
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
  <title>CharlestonHacks - Home</title>
  <meta name="description" content="CharlestonHacks â€” Making Invisible Networks Visible."/>
  <meta property="og:image" content="images/websitepanel.webp"/>
  <meta property="og:url" content="https://charlestonhacks.com"/>
  <meta name="theme-color" content="#0a0a0a"/>
  <link rel="icon" href="favicon.ico" type="image/x-icon"/>
  <link rel="apple-touch-icon" href="images/apple-touch-icon.png"/>
  <link rel="manifest" href="/manifest.json"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link rel="stylesheet" href="styles.css"/>

  <style>
/* ============================
   BBS POPUP WINDOW (CLEAN)
============================ */
.bbs-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  backdrop-filter: blur(4px);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 1600;
}

.bbs-overlay.active {
  display: flex;
}

.bbs-window {
  background: #000;
  border: 2px solid #0f0;
  width: 90%;
  max-width: 600px;
  padding: 1.2rem;
  color: #0f0;
  font-family: "Courier New", monospace;
  border-radius: 10px;
  box-shadow: 0 0 20px rgba(0,255,0,0.5);
  position: relative;
  animation: bbsSlideUp .25s ease-out;
}

@keyframes bbsSlideUp {
  from { transform: translateY(22px); opacity: 0; }
  to   { transform: translateY(0); opacity: 1; }
}

.bbs-title {
  text-align: center;
  color: #0f0;
  margin-bottom: .8rem;
  text-shadow: 0 0 8px #0f0;
}

#bbs-screen {
  height: 220px;
  overflow-y: auto;
  white-space: pre-wrap;
  padding: .5rem;
  border: 1px solid #0f0;
  margin-bottom: .7rem;
}

#bbs-form {
  display: flex;
  align-items: center;
}

.bbs-prompt {
  margin-right: .5rem;
  color: #0f0;
}

#bbs-input {
  flex: 1;
  background: #000;
  color: #0f0;
  border: none;
  outline: none;
  font-size: 14px;
  caret-color: #0f0;
}

.bbs-close-btn {
  position: absolute;
  top: 8px;
  right: 10px;
  background: none;
  border: none;
  color: #0f0;
  font-size: 1.5rem;
  cursor: pointer;
}

/* ============================
   UI + SITE ELEMENTS
============================ */

/* Scrollbar (Events List) */
.events-modal div::-webkit-scrollbar {
  width: 8px;
}
.events-modal div::-webkit-scrollbar-track {
  background: rgba(255,255,255,0.08);
}
.events-modal div::-webkit-scrollbar-thumb {
  background: rgba(0,224,255,0.6);
  border-radius: 4px;
}

:root {
  --gold: #c9a35e;
  --cyan: #00e0ff;
  --bg-dark: #000;
}

body {
  margin: 0;
  background: var(--bg-dark);
  color: #fff;
  font-family: 'Orbitron', sans-serif;
  overflow-x: hidden;
}

/* Splash */
#splash-overlay {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at 50% 50%, #020203 0%, #000 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  transition: opacity .4s ease;
}

#splash-overlay.fade-out {
  opacity: 0;
  pointer-events: none;
}

/* Countdown */
#countdown span {
  color: var(--gold);
  margin: 0 .15rem;
  text-shadow: 0 0 10px rgba(201,163,94,0.7);
}

/* Events Modal */
#events-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.85);
  display: none;
  justify-content: center;
  align-items: center;
  backdrop-filter: blur(6px);
  z-index: 1500;
  pointer-events: none;
}

#events-overlay.active {
  display: flex;
  pointer-events: auto;
}

/* Icon Bar */
.icons-container {
  display: flex;
  justify-content: center;
  gap: .55rem;
  margin: 1.4rem auto 2rem;
}

.icons-container a {
  color: #fff;
  font-size: 1.4rem;
  width: 34px;
  height: 34px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform .2s ease;
}

.icons-container a:hover {
  transform: scale(1.18);
}

/* ============================
   PORTAL CARD - STABILIZED
   Prevents hover shift issues
============================ */
.media-container {
  position: relative;
  perspective: 1000px;
  transform: translateZ(0);
  isolation: isolate;
}

/* Lock the main card image - NO transforms on hover */
#missionImage {
  backface-visibility: hidden;
  transform: translateZ(0) !important;
  transition: none !important;
  will-change: auto;
  pointer-events: none; /* Let clicks pass through to buttons */
}

#cardFrame {
  backface-visibility: hidden;
  transform: translateZ(0) !important;
  transition: none !important;
  pointer-events: none;
}

/* Ensure clickable areas stay in place */
.clickable-area {
  transform: translateZ(0);
  transform-origin: center center;
}

.clickable-area:hover {
  transform: translateZ(0);
}

/* Ensure video doesn't cause shifts */
#missionVideo {
  pointer-events: none;
}
  </style>
</head>

<body>
  <canvas id="neural-bg"></canvas>

  <!-- Splash -->
  <div id="splash-overlay" role="dialog" aria-modal="true">
    <div id="splash-content">
      <img src="images/charlestonhackslogo.svg" style="width:200px;" alt="CharlestonHacks Logo"/>
      <h1 id="splash-title">Welcome to CharlestonHacks</h1>
      <p id="splash-desc">Loadingâ€¦</p>

      <label style="margin-top:1em;font-size:.9rem;">
        <input type="checkbox" id="dont-show-again"> Don't show this again
      </label>

      <div>
        <button id="community-site-btn" class="btn">Community Site</button>
        <button id="public-site-btn" class="btn">Public Site</button>
      </div>

      <p style="font-size:.8rem;opacity:.7;margin-top:2rem;">
        Â© 2025 CharlestonHacks. All rights reserved.
      </p>
    </div>
  </div>

  <!-- Sounds -->
  <audio id="cardflipSound" src="assets/atmospherel.m4a" preload="auto"></audio>
  <audio id="chimeSound" src="assets/chime.mp3" preload="auto"></audio>
  <audio id="keysSound" src="assets/keys.m4a" preload="auto"></audio>

  <!-- Main -->
  <main>
    <div class="main-wrapper">
      <div class="media-container">
        <div id="countdown"></div>
        <div id="btcPrice"></div>

        <img id="missionImage" src="icons/card.png" alt="Big Card"/>
        <img id="cardFrame" src="images/cardframe2.svg" style="display:none;" alt="Frame"/>
        <video id="missionVideo" muted playsinline controls style="display:none;opacity:0;">
          <source src="" type="video/mp4">
        </video>

        <!-- Card interactive buttons -->
        <button type="button" class="clickable-area top-left" data-sound="chime" data-url="Poster.html" data-info="Learn more about the event poster.">
          <img src="images/informationbutton.webp" alt="Info">
        </button>
        <button type="button" class="clickable-area top-center" data-sound="chime" data-url="docs.html" data-info="Event documentation.">
          <img src="images/crestn.svg" alt="Docs">
        </button>
        <button type="button" class="clickable-area top-right" data-sound="chime" data-url="2card.html" data-info="Explore the innovation engine.">
          <img src="images/innovationenginebutton.webp" alt="Innovation">
        </button>
        <button type="button" class="clickable-area middle-left" data-sound="chime" data-url="experimental.html" data-info="Sandbox environment.">
          <img src="images/experiment.webp" alt="Experiment">
        </button>
        <button type="button" class="clickable-area middle-right" data-sound="chime" data-url="swag.html" data-info="View and order event swag.">
          <img src="images/case.webp" alt="Case">
        </button>
        <button type="button" class="clickable-area bottom-left" data-sound="chime" data-url="news.html" data-info="Catch up on news.">
          <img src="images/newsbutton.webp" alt="News">
        </button>
        <button type="button" class="clickable-area bottom-center" data-sound="keys" data-url="donations.html" data-info="Sponsor CharlestonHacks.">
          <img src="images/keysn.svg" alt="Keys">
        </button>
        <button type="button" class="clickable-area bottom-right" data-sound="chime" data-url="cardmatchgame.html" data-info="Play the card match game.">
          <img src="images/peoplebutton.webp" alt="People">
        </button>

        <div id="infoLine" class="info-line">
          <span id="infoParticle"></span><span id="infoText"></span>
        </div>
      </div>
    </div>

    <!-- ICON BAR -->
    <section class="icons-container">
      <a href="https://github.com/sponsors/deckerd451" target="_blank" title="Sponsor"><i class="fas fa-heart"></i></a>
      <a href="2card.html" title="Community"><i class="fas fa-people-arrows"></i></a>
      <a href="subscribe.html" title="Subscribe"><i class="fas fa-bell"></i></a>
      <a href="https://www.linkedin.com/company/charlestonhacks" target="_blank" title="LinkedIn"><i class="fab fa-linkedin"></i></a>
      <a href="https://www.instagram.com/charlestonhacks/" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
      <a href="mailto:hello@charlestonhacks.com" title="Email"><i class="fas fa-envelope"></i></a>
      <a href="https://www.facebook.com/deckerdb26354" target="_blank" title="Facebook"><i class="fab fa-facebook"></i></a>
      <a id="open-calendar" title="View Charleston Events" style="cursor:pointer;"><i class="fas fa-calendar-alt"></i></a>
      <a id="open-bbs" title="Open BBS Terminal" style="cursor:pointer;"><i class="fas fa-terminal"></i></a>
    </section>

    <!-- BBS POPUP WINDOW -->
    <div id="bbs-overlay" class="bbs-overlay">
      <div class="bbs-window">
        <button id="close-bbs" class="bbs-close-btn" aria-label="Close BBS">Ã—</button>
        <h2 class="bbs-title">CharlestonHacks BBS</h2>

        <div id="bbs-screen"></div>

        <form id="bbs-form">
          <span class="bbs-prompt">></span>
          <input id="bbs-input" type="text" autocomplete="off" placeholder="type messageâ€¦">
        </form>

        <div id="bbs-online" style="margin-top:1rem;">
          <strong>Online:</strong>
          <div id="bbs-online-list"></div>
        </div>
      </div>
    </div>

  </main>

  <!-- Events Modal -->
  <div id="events-overlay">
    <div class="events-modal">
      <h2>Upcoming Charleston Events</h2>
      <div id="events-list"></div>
      <button id="close-overlay">Close</button>
    </div>
  </div>

  <!-- Splash Logic -->
  <script>
    (function(){
      const splash = document.getElementById("splash-overlay");
      const cBtn = document.getElementById("community-site-btn");
      const pBtn = document.getElementById("public-site-btn");
      const box = document.getElementById("dont-show-again");
      const KEY = "chs_splash_seen_once";

      function hide(immediate = false) {
        splash.classList.add("fade-out");
        document.body.classList.remove("splash-active");
        setTimeout(() => splash.style.display = "none", immediate ? 0 : 400);
      }

      function dismiss() {
        if (box.checked) localStorage.setItem(KEY, "true");
        hide();
      }

      window.addEventListener("DOMContentLoaded", () => {
        if (localStorage.getItem(KEY) === "true") {
          hide(true);
          return;
        }
        splash.style.display = "flex";
        document.body.classList.add("splash-active");

        cBtn.onclick = e => {
          e.preventDefault();
          dismiss();
        };

        pBtn.onclick = e => {
          e.preventDefault();
          dismiss();
          window.location.href = "https://charlestonhacks.mailchimpsites.com/";
        };
      });
    })();
  </script>

  <!-- MAIN LOGIC - Portal System -->
  <script type="module">
    import { CONFIG } from "./assets/js/config.js";
    import { initCardFlip } from "./assets/js/cardFlip.js";
    import { startBTCPriceTracker } from "./assets/js/btc.js";

    // Set up sound configuration
    CONFIG.sounds = {
      cardflip: document.getElementById("cardflipSound"),
      chime: document.getElementById("chimeSound"),
      keys: document.getElementById("keysSound")
    };

    // Initialize portal card system
    initCardFlip(CONFIG);
    
    // Start BTC tracker
    startBTCPriceTracker("btcPrice");

    console.log('ðŸŒ€ CharlestonHacks Portal System Active');
  </script>

  <!-- Core JS (Sequential loading for Supabase timing) -->
  <script type="module">
    import "/assets/js/neuralBackground.js";
    import "/assets/js/supabaseClient.js";
    import "/assets/js/bbs.js";
  </script>

  <!-- Events Loader -->
  <script type="module">
    async function loadEventsFeedWhenReady() {
      while (!document.getElementById("events-list")) {
        await new Promise(r => setTimeout(r, 40));
      }
      await import("/assets/js/eventsFeed.js");
    }
    window.addEventListener("DOMContentLoaded", loadEventsFeedWhenReady);
  </script>

  <!-- BBS & Calendar Modal Controls -->
  <script>
    // BBS Modal
    document.getElementById("open-bbs")?.addEventListener("click", () => {
      document.getElementById("bbs-overlay").classList.add("active");
      document.getElementById("bbs-input")?.focus();
    });

    document.getElementById("close-bbs")?.addEventListener("click", () => {
      document.getElementById("bbs-overlay").classList.remove("active");
    });

    // Close BBS when clicking outside window
    document.getElementById("bbs-overlay")?.addEventListener("click", (e) => {
      const win = document.querySelector(".bbs-window");
      if (win && !win.contains(e.target)) {
        document.getElementById("bbs-overlay").classList.remove("active");
      }
    });

    // Calendar Modal
    document.getElementById("open-calendar")?.addEventListener("click", () => {
      document.getElementById("events-overlay").classList.add("active");
    });

    document.getElementById("close-overlay")?.addEventListener("click", () => {
      document.getElementById("events-overlay").classList.remove("active");
    });

    // Close events modal when clicking outside
    document.getElementById("events-overlay")?.addEventListener("click", (e) => {
      const modal = document.querySelector(".events-modal");
      if (modal && !modal.contains(e.target)) {
        document.getElementById("events-overlay").classList.remove("active");
      }
    });

    // Escape key closes modals
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        document.getElementById("bbs-overlay")?.classList.remove("active");
        document.getElementById("events-overlay")?.classList.remove("active");
      }
    });
  </script>

</body>
</html>
