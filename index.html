<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8" />

  <!-- Neuron redirect (keeps querystring, removes source=neuron) -->
  <script>
    (function () {
      const params = new URLSearchParams(window.location.search);
      if (params.get("source") === "neuron") {
        params.delete("source");
        const qs = params.toString();
        window.location.replace("/neural.html" + (qs ? "?" + qs : ""));
      }
    })();
  </script>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-6NDKG07DY6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag("js", new Date());
    gtag("config", "G-6NDKG07DY6");
  </script>

  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
  <title>CharlestonHacks - Portal to Innovation</title>
  <meta name="description" content="CharlestonHacks â€” Making Invisible Networks Visible. Explore 9 interactive portals to innovation, community, and collaboration."/>
  <meta property="og:image" content="images/websitepanel.webp"/>
  <meta property="og:url" content="https://charlestonhacks.com"/>
  <meta name="theme-color" content="#0a0a0a"/>
  <link rel="icon" href="favicon.ico" type="image/x-icon"/>
  <link rel="apple-touch-icon" href="images/apple-touch-icon.png"/>
  <link rel="manifest" href="/manifest.json"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
  <link rel="stylesheet" href="styles.css"/>

  <style>
/* ============================
   DESIGN SYSTEM & VARIABLES
============================ */
:root {
  --gold: #c9a35e;
  --gold-glow: rgba(201, 163, 94, 0.6);
  --cyan: #00e0ff;
  --cyan-glow: rgba(0, 224, 255, 0.4);
  --bg-dark: #000;
  --bg-card: #0a0a0a;
  --text-primary: #fff;
  --text-secondary: #aaa;
  --shadow-subtle: 0 4px 20px rgba(0, 0, 0, 0.3);
  --shadow-glow: 0 0 30px var(--cyan-glow);
  --border-radius: 12px;
  --transition-smooth: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-bounce: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

* { box-sizing: border-box; }

body {
  margin: 0;
  background: var(--bg-dark);
  color: var(--text-primary);
  font-family: 'Orbitron', sans-serif;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
}

/* ============================
   ENHANCED SPLASH SCREEN
============================ */
#splash-overlay {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at 50% 50%, #020203 0%, #000 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  transition: opacity 0.6s ease, transform 0.6s ease;
}

#splash-overlay.fade-out {
  opacity: 0;
  transform: scale(0.95);
  pointer-events: none;
}

#splash-content { text-align: center; animation: splashFadeIn 0.8s ease-out; }

@keyframes splashFadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to   { opacity: 1; transform: translateY(0); }
}

#splash-title {
  font-size: 2rem;
  margin: 1.5rem 0 0.5rem;
  background: linear-gradient(135deg, var(--gold), var(--cyan));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  animation: shimmer 3s ease-in-out infinite;
}

@keyframes shimmer {
  0%, 100% { opacity: 1; }
  50%      { opacity: 0.8; }
}

.btn {
  background: linear-gradient(135deg, var(--gold), #d4b684);
  color: #000;
  border: none;
  padding: 0.8rem 2rem;
  margin: 0.5rem;
  border-radius: 50px;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition-smooth);
  font-family: 'Orbitron', sans-serif;
  box-shadow: 0 4px 15px var(--gold-glow);
}

.btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px var(--gold-glow); }
.btn:active { transform: translateY(0); }

/* ============================
   FIRST VISIT TUTORIAL
============================ */
#tutorial-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.95);
  backdrop-filter: blur(8px);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 1800;
  animation: fadeIn 0.4s ease;
}
#tutorial-overlay.active { display: flex; }

.tutorial-content {
  text-align: center;
  max-width: 600px;
  padding: 2rem;
  animation: slideUp 0.5s ease-out;
}

@keyframes slideUp {
  from { opacity: 0; transform: translateY(30px); }
  to   { opacity: 1; transform: translateY(0); }
}

.tutorial-content h2 {
  font-size: 2.5rem;
  margin-bottom: 1rem;
  color: var(--cyan);
  text-shadow: 0 0 20px var(--cyan-glow);
}

.tutorial-content p {
  font-size: 1.1rem;
  line-height: 1.6;
  color: var(--text-secondary);
  margin-bottom: 2rem;
}

.tutorial-step {
  background: rgba(0, 224, 255, 0.05);
  border: 1px solid var(--cyan);
  border-radius: var(--border-radius);
  padding: 1.5rem;
  margin: 1rem 0;
  transition: var(--transition-smooth);
}
.tutorial-step:hover { background: rgba(0, 224, 255, 0.1); transform: translateX(5px); }
.tutorial-step i { font-size: 2rem; color: var(--cyan); margin-bottom: 0.5rem; display: block; }

#skip-tutorial {
  background: transparent;
  border: 2px solid var(--cyan);
  color: var(--cyan);
  padding: 0.8rem 2rem;
  border-radius: 50px;
  cursor: pointer;
  transition: var(--transition-smooth);
  font-family: 'Orbitron', sans-serif;
  margin-top: 1rem;
}
#skip-tutorial:hover { background: var(--cyan); color: #000; box-shadow: 0 0 20px var(--cyan-glow); }

/* ============================
   DISCOVERY PROGRESS TRACKER
============================ */
#discovery-tracker {
  position: fixed;
  top: 20px;
  left: 20px;
  background: rgba(0, 0, 0, 0.9);
  border: 2px solid var(--gold);
  border-radius: var(--border-radius);
  padding: 1rem 1.5rem;
  z-index: 1000;
  backdrop-filter: blur(10px);
  opacity: 0;
  transform: translateX(-20px);
  transition: var(--transition-smooth);
}
#discovery-tracker.visible { opacity: 1; transform: translateX(0); }
#discovery-tracker h3 {
  margin: 0 0 0.5rem;
  font-size: 0.9rem;
  color: var(--gold);
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.progress-bar {
  width: 200px;
  height: 8px;
  background: rgba(201, 163, 94, 0.2);
  border-radius: 10px;
  overflow: hidden;
  position: relative;
}
.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--gold), var(--cyan));
  border-radius: 10px;
  width: 0%;
  transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow: 0 0 10px var(--gold-glow);
}
.portals-found { font-size: 0.85rem; color: var(--text-secondary); margin-top: 0.3rem; }

/* ============================
   MAIN CARD ENHANCEMENTS
============================ */
.main-wrapper {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 2rem;
  position: relative;
}

.media-container {
  position: relative;
  perspective: 1500px;
  transform-style: preserve-3d;
  animation: cardEntrance 1.2s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes cardEntrance {
  0% { opacity: 0; transform: translateY(50px) rotateX(15deg) scale(0.9); }
  100% { opacity: 1; transform: translateY(0) rotateX(0) scale(1); }
}

/* Breathing animation for card */
@keyframes breathe {
  0%, 100% { transform: scale(1); }
  50%      { transform: scale(1.02); }
}
.media-container.idle #missionImage { animation: breathe 6s ease-in-out infinite; }

/* Interactive zone highlights */
.clickable-area {
  position: absolute;
  transition: var(--transition-bounce);
  filter: brightness(1);
  cursor: pointer;
  transform-origin: center;
  border: none;
  background: transparent;
  padding: 0;
}

/* Center portal special styling */
.clickable-area.center {
  border-radius: 50%;
  background: radial-gradient(circle, rgba(0, 224, 255, 0.03) 0%, transparent 70%);
}

.clickable-area.center::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle, var(--cyan-glow) 0%, transparent 70%);
  opacity: 0;
  transition: opacity 0.6s ease;
  border-radius: 50%;
  pointer-events: none;
  animation: centerPulse 3s ease-in-out infinite;
}

@keyframes centerPulse {
  0%, 100% { transform: scale(0.95); opacity: 0.1; }
  50%      { transform: scale(1.05); opacity: 0.2; }
}

.clickable-area.center:hover::before {
  opacity: 0.4;
  animation: centerPulseFast 1s ease-in-out infinite;
}

@keyframes centerPulseFast {
  0%, 100% { transform: scale(1); opacity: 0.3; }
  50%      { transform: scale(1.1); opacity: 0.6; }
}

.clickable-area::before {
  content: '';
  position: absolute;
  inset: -10px;
  background: radial-gradient(circle, var(--cyan-glow) 0%, transparent 70%);
  opacity: 0;
  transition: opacity 0.4s ease;
  border-radius: 50%;
  pointer-events: none;
  z-index: -1;
}

.clickable-area:hover::before { opacity: 1; animation: pulseGlow 1.5s ease-in-out infinite; }

@keyframes pulseGlow {
  0%, 100% { transform: scale(1); opacity: 0.6; }
  50%      { transform: scale(1.2); opacity: 0.8; }
}

.clickable-area:hover {
  filter: brightness(1.3) drop-shadow(0 0 15px var(--cyan));
  transform: scale(1.15);
  z-index: 10;
}

.clickable-area.discovered { filter: brightness(1.1); }

.clickable-area.discovered::after {
  content: 'âœ“';
  position: absolute;
  top: -8px;
  right: -8px;
  background: var(--gold);
  color: #000;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: bold;
  box-shadow: 0 0 10px var(--gold-glow);
  animation: checkmarkPop 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes checkmarkPop {
  0% { transform: scale(0) rotate(-180deg); }
  100% { transform: scale(1) rotate(0); }
}

/* ============================
   TOOLTIP
============================ */
.info-line {
  position: absolute;
  top: 15%;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0, 0, 0, 0.95);
  border: 2px solid var(--cyan);
  padding: 1rem 1.8rem;
  border-radius: var(--border-radius);
  min-width: 320px;
  max-width: 500px;
  text-align: center;
  opacity: 0;
  transition: var(--transition-smooth);
  pointer-events: none;
  backdrop-filter: blur(15px);
  box-shadow: 0 8px 30px rgba(0, 224, 255, 0.5), 0 0 60px rgba(0, 0, 0, 0.8);
  z-index: 100;
}

.info-line.visible {
  opacity: 1;
  transform: translateX(-50%) scale(1.02);
}

#infoParticle {
  display: inline-block;
  width: 8px;
  height: 8px;
  background: var(--cyan);
  border-radius: 50%;
  margin-right: 0.5rem;
  animation: particlePulse 1s ease-in-out infinite;
  box-shadow: 0 0 10px var(--cyan);
}

@keyframes particlePulse {
  0%, 100% { transform: scale(1); opacity: 1; }
  50%      { transform: scale(1.3); opacity: 0.7; }
}

#infoText { font-size: 0.95rem; color: var(--cyan); font-weight: 500; }

/* ============================
   ICON BAR
============================ */
.icons-container {
  display: flex;
  justify-content: center;
  gap: 0.8rem;
  margin: 2rem auto;
  padding: 1.2rem 2rem;
  background: rgba(0, 0, 0, 0.5);
  border-radius: 50px;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  animation: iconBarSlideIn 0.8s ease-out 0.5s both;
}

@keyframes iconBarSlideIn {
  from { opacity: 0; transform: translateY(20px); }
  to   { opacity: 1; transform: translateY(0); }
}

.icons-container a {
  position: relative;
  color: #fff;
  font-size: 1.5rem;
  width: 45px;
  height: 45px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: var(--transition-smooth);
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.05);
}

.icons-container a::before {
  content: attr(title);
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%) translateY(-5px);
  background: rgba(0, 0, 0, 0.95);
  color: var(--cyan);
  padding: 0.4rem 0.8rem;
  border-radius: 6px;
  font-size: 0.75rem;
  white-space: nowrap;
  opacity: 0;
  pointer-events: none;
  transition: var(--transition-smooth);
  border: 1px solid var(--cyan);
  font-family: 'Orbitron', sans-serif;
}

.icons-container a:hover {
  transform: translateY(-5px);
  background: rgba(0, 224, 255, 0.1);
  box-shadow: 0 5px 20px var(--cyan-glow);
  color: var(--cyan);
}

.icons-container a:hover::before {
  opacity: 1;
  transform: translateX(-50%) translateY(-10px);
}

/* ============================
   MATRIX BTC OVERLAY
============================ */
#matrix-btc-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.95);
  backdrop-filter: blur(10px);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 2000;
  overflow: hidden;
}

#matrix-btc-overlay.active { display: flex; animation: fadeIn 0.3s ease; }

#matrix-canvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  opacity: 0.6;
  z-index: 1;
}

.btc-data-container {
  position: relative;
  z-index: 2;
  text-align: center;
  opacity: 0;
  transform: scale(0.8);
  transition: all 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}
.btc-data-container.visible { opacity: 1; transform: scale(1); }

.btc-main-price {
  font-size: 5rem;
  font-weight: bold;
  color: #00ff00;
  text-shadow: 0 0 20px #00ff00, 0 0 40px #00ff00;
  margin-bottom: 1rem;
  font-family: 'Courier New', monospace;
  letter-spacing: 0.1em;
  animation: glitchPrice 3s infinite;
}

@keyframes glitchPrice {
  0%, 90%, 100% { text-shadow: 0 0 20px #00ff00, 0 0 40px #00ff00; }
  95% { text-shadow: 0 0 20px #ff0000, 0 0 40px #ff0000; transform: translateX(2px); }
}

.btc-label {
  font-size: 1.5rem;
  color: #00ff00;
  text-shadow: 0 0 10px #00ff00;
  margin-bottom: 2rem;
  font-family: 'Courier New', monospace;
  letter-spacing: 0.2em;
}

.btc-stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1.5rem;
  max-width: 900px;
  margin: 2rem auto;
}

.btc-stat-card {
  background: rgba(0, 255, 0, 0.05);
  border: 1px solid #00ff00;
  padding: 1.5rem;
  border-radius: 8px;
  box-shadow: 0 0 20px rgba(0, 255, 0, 0.2);
  transition: all 0.3s ease;
}

.btc-stat-card:hover {
  background: rgba(0, 255, 0, 0.1);
  box-shadow: 0 0 30px rgba(0, 255, 0, 0.4);
  transform: translateY(-5px);
}

.btc-stat-label {
  font-size: 0.9rem;
  color: #00ff00;
  opacity: 0.7;
  margin-bottom: 0.5rem;
  font-family: 'Courier New', monospace;
  text-transform: uppercase;
  letter-spacing: 0.1em;
}
.btc-stat-value {
  font-size: 1.5rem;
  color: #00ff00;
  font-weight: bold;
  text-shadow: 0 0 10px #00ff00;
  font-family: 'Courier New', monospace;
}
.btc-stat-value.negative { color: #ff0000; text-shadow: 0 0 10px #ff0000; }

.btc-mini-chart {
  background: rgba(0, 255, 0, 0.05);
  border: 1px solid #00ff00;
  padding: 1rem;
  border-radius: 8px;
  margin-top: 2rem;
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}

.chart-placeholder {
  height: 150px;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #00ff00;
  font-family: 'Courier New', monospace;
  font-size: 0.9rem;
  opacity: 0.7;
}

.btc-close-btn {
  position: absolute;
  top: 30px;
  right: 30px;
  background: transparent;
  border: 2px solid #00ff00;
  color: #00ff00;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  font-size: 1.5rem;
  cursor: pointer;
  transition: all 0.3s ease;
  z-index: 10;
  font-family: 'Courier New', monospace;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
}
.btc-close-btn:hover {
  background: #00ff00;
  color: #000;
  transform: rotate(90deg) scale(1.1);
  box-shadow: 0 0 30px rgba(0, 255, 0, 0.6);
}

.btc-loading {
  font-size: 2rem;
  color: #00ff00;
  font-family: 'Courier New', monospace;
  text-shadow: 0 0 20px #00ff00;
  animation: pulse 1.5s infinite;
}

@keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

/* ============================
   EVENTS MODAL
============================ */
#events-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.9);
  display: none;
  justify-content: center;
  align-items: center;
  backdrop-filter: blur(10px);
  z-index: 1500;
  pointer-events: none;
}
#events-overlay.active { display: flex; pointer-events: auto; animation: fadeIn 0.3s ease; }

.events-modal {
  background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
  border: 2px solid var(--cyan);
  border-radius: var(--border-radius);
  padding: 2rem;
  max-width: 600px;
  width: 90%;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 0 50px var(--cyan-glow);
  animation: modalSlideIn 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

@keyframes modalSlideIn {
  from { transform: scale(0.9) translateY(20px); opacity: 0; }
  to   { transform: scale(1) translateY(0); opacity: 1; }
}

.events-modal h2 {
  color: var(--cyan);
  text-align: center;
  margin-bottom: 1.5rem;
  text-shadow: 0 0 20px var(--cyan-glow);
  font-size: 1.8rem;
}

#close-overlay {
  display: block;
  width: 100%;
  margin-top: 1.5rem;
  background: transparent;
  border: 2px solid var(--cyan);
  color: var(--cyan);
  padding: 0.8rem;
  border-radius: 50px;
  cursor: pointer;
  transition: var(--transition-smooth);
  font-family: 'Orbitron', sans-serif;
  font-weight: 600;
}
#close-overlay:hover { background: var(--cyan); color: #000; box-shadow: 0 0 20px var(--cyan-glow); }

/* ============================
   RESPONSIVE / ACCESSIBILITY
============================ */
@media (max-width: 768px) {
  #discovery-tracker { top: 10px; left: 10px; padding: 0.8rem 1rem; }
  .progress-bar { width: 150px; }
  .tutorial-content h2 { font-size: 1.8rem; }
  .icons-container { gap: 0.5rem; padding: 1rem 1.5rem; }
  .icons-container a { width: 40px; height: 40px; font-size: 1.2rem; }
  .clickable-area.center { width: 150px !important; height: 150px !important; }
  .info-line { min-width: 280px; max-width: 85vw; font-size: 0.9rem; padding: 0.8rem 1.2rem; top: 20%; }
  .btc-main-price { font-size: 3rem; }
  .btc-stats-grid { grid-template-columns: 1fr; gap: 1rem; }
  .btc-stat-card { padding: 1rem; }
  .btc-close-btn { top: 15px; right: 15px; width: 40px; height: 40px; }
}

@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

.clickable-area:focus,
.icons-container a:focus,
button:focus { outline: 2px solid var(--cyan); outline-offset: 4px; }

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}
  </style>
</head>

<body>
  <canvas id="neural-bg"></canvas>

  <!-- Enhanced Splash Screen -->
  <div id="splash-overlay" role="dialog" aria-modal="true" aria-labelledby="splash-title">
    <div id="splash-content">
      <img src="images/charlestonhackslogo.svg" style="width:220px;" alt="CharlestonHacks Logo"/>
      <h1 id="splash-title">Welcome to CharlestonHacks</h1>
      <p id="splash-desc">Making Invisible Networks Visible</p>

      <label style="margin-top:1.5em;font-size:.9rem;display:block;">
        <input type="checkbox" id="dont-show-again"> Don't show this again
      </label>

      <div style="margin-top:1.5rem;">
        <button id="community-site-btn" class="btn">Enter Portal</button>
        <button id="public-site-btn" class="btn" style="background:transparent;border:2px solid var(--cyan);color:var(--cyan);">Public Site</button>
      </div>

      <p style="font-size:.8rem;opacity:.7;margin-top:2rem;">
        Â© 2026 CharlestonHacks. All rights reserved.
      </p>
    </div>
  </div>

  <!-- First Visit Tutorial -->
  <div id="tutorial-overlay" role="dialog" aria-modal="true">
    <div class="tutorial-content">
      <h2>ðŸŒŸ Discover 9 Portals</h2>
      <p>Each icon on the card unlocks a different dimension of CharlestonHacks. Hover to reveal, click to explore.</p>

      <div class="tutorial-step">
        <i class="fas fa-mouse-pointer"></i>
        <strong>Hover</strong> over the card icons to preview each portal
      </div>

      <div class="tutorial-step">
        <i class="fas fa-hand-pointer"></i>
        <strong>Click</strong> to enter and discover new features
      </div>

      <div class="tutorial-step">
        <i class="fas fa-trophy"></i>
        Track your progress as you <strong>explore all 9 portals</strong>
      </div>

      <button id="skip-tutorial">Start Exploring</button>
    </div>
  </div>

  <!-- Discovery Progress Tracker -->
  <div id="discovery-tracker" role="status" aria-live="polite">
    <h3><i class="fas fa-compass"></i> Discovery Progress</h3>
    <div class="progress-bar">
      <div class="progress-fill" id="progress-fill"></div>
    </div>
    <p class="portals-found"><span id="portals-count">0</span>/9 Portals Discovered</p>
  </div>

  <!-- Sounds -->
  <audio id="cardflipSound" src="assets/atmospherel.m4a" preload="auto"></audio>
  <audio id="chimeSound" src="assets/chime.mp3" preload="auto"></audio>
  <audio id="keysSound" src="assets/keys.m4a" preload="auto"></audio>

  <!-- Main Content -->
  <main>
    <div class="main-wrapper">
      <div class="media-container">
        <!-- Main Card -->
        <img id="missionImage" src="icons/card.png" alt="Interactive Portal Card - Discover 9 different features"/>
        <img id="cardFrame" src="images/cardframe2.svg" style="display:none;" alt="Portal Frame"/>

        <!-- Optional (if you ever want to flip to video) -->
        <video id="missionVideo" muted playsinline controls style="display:none;opacity:0;">
          <source src="" type="video/mp4">
        </video>

        <!-- Interactive Portal Buttons -->
        <button type="button"
                class="clickable-area top-left"
                data-sound="chime"
                data-url="Poster.html"
                data-info="ðŸ“‹ Event Poster - View the official event artwork"
                data-portal="poster"
                aria-label="Event Poster Portal">
          <img src="images/informationbutton.webp" alt="">
        </button>

        <button type="button"
                class="clickable-area top-center"
                data-sound="chime"
                data-url="docs.html"
                data-info="ðŸ“š Documentation - Explore guides and resources"
                data-portal="docs"
                aria-label="Documentation Portal">
          <img src="images/crestn.svg" alt="">
        </button>

        <button type="button"
                class="clickable-area top-right"
                data-sound="chime"
                data-url="dashboard.html"
                data-info="ðŸš€ Innovation Engine - Connect with the community"
                data-portal="innovation"
                aria-label="Innovation Engine Portal">
          <img src="images/innovationenginebutton.webp" alt="">
        </button>

        <button type="button"
                class="clickable-area middle-left"
                data-sound="chime"
                data-url="experimental.html"
                data-info="ðŸ§ª Sandbox - Experimental features and tools"
                data-portal="sandbox"
                aria-label="Sandbox Portal">
          <img src="images/experiment.webp" alt="">
        </button>

        <button type="button"
                class="clickable-area middle-right"
                data-sound="chime"
                data-url="swag.html"
                data-info="ðŸŽ Swag Store - Official CharlestonHacks merchandise"
                data-portal="swag"
                aria-label="Swag Store Portal">
          <img src="images/case.webp" alt="">
        </button>

        <button type="button"
                class="clickable-area bottom-left"
                data-sound="chime"
                data-url="news.html"
                data-info="ðŸ“° News Feed - Latest updates and announcements"
                data-portal="news"
                aria-label="News Portal">
          <img src="images/newsbutton.webp" alt="">
        </button>

        <button type="button"
                class="clickable-area bottom-center"
                data-sound="keys"
                data-url="donations.html"
                data-info="ðŸ’ Support Us - Become a sponsor or donate"
                data-portal="sponsor"
                aria-label="Sponsorship Portal">
          <img src="images/keysn.svg" alt="">
        </button>

        <button type="button"
                class="clickable-area bottom-right"
                data-sound="chime"
                data-url="cardmatchgame.html"
                data-info="ðŸŽ® Card Match Game - Test your memory skills"
                data-portal="game"
                aria-label="Game Portal">
          <img src="images/peoplebutton.webp" alt="">
        </button>

        <!-- Center Portal (Bitcoin Tracker) -->
        <button type="button"
                class="clickable-area center"
                data-sound="cardflip"
                data-url="#"
                data-info="â‚¿ Bitcoin Tracker - Click to reveal live BTC price"
                data-portal="center"
                aria-label="Bitcoin Tracker Portal"
                style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%);
                       width:200px; height:200px; z-index:5;">
          <span class="sr-only">Bitcoin Tracker</span>
        </button>

        <!-- Tooltip -->
        <div id="infoLine" class="info-line" role="tooltip">
          <span id="infoParticle"></span><span id="infoText"></span>
        </div>
      </div>
    </div>

    <!-- Icon Bar -->
    <section class="icons-container" role="navigation" aria-label="Quick Access">
      <a href="https://github.com/sponsors/deckerd451" target="_blank" title="Sponsor on GitHub" aria-label="Sponsor on GitHub">
        <i class="fas fa-heart"></i>
      </a>
      <a href="dashboard.html" title="Community Hub" aria-label="Community Hub">
        <i class="fas fa-people-arrows"></i>
      </a>
      <a href="subscribe.html" title="Subscribe to Updates" aria-label="Subscribe">
        <i class="fas fa-bell"></i>
      </a>
      <a href="https://www.linkedin.com/company/charlestonhacks" target="_blank" title="LinkedIn" aria-label="LinkedIn">
        <i class="fab fa-linkedin"></i>
      </a>
      <a href="https://www.instagram.com/charlestonhacks/" target="_blank" title="Instagram" aria-label="Instagram">
        <i class="fab fa-instagram"></i>
      </a>
      <a href="mailto:hello@charlestonhacks.com" title="Email Us" aria-label="Email">
        <i class="fas fa-envelope"></i>
      </a>
      <a href="https://www.facebook.com/deckerdb26354" target="_blank" title="Facebook" aria-label="Facebook">
        <i class="fab fa-facebook"></i>
      </a>
      <a id="open-calendar" title="Charleston Events Calendar" aria-label="Events Calendar" style="cursor:pointer;">
        <i class="fas fa-calendar-alt"></i>
      </a>
    </section>
  </main>

  <!-- Events Modal -->
  <div id="events-overlay" role="dialog" aria-modal="true" aria-labelledby="events-title">
    <div class="events-modal">
      <h2 id="events-title">Upcoming Charleston Events</h2>
      <div id="events-list" role="list"></div>
      <button id="close-overlay">Close</button>
    </div>
  </div>

  <!-- Matrix-Style Bitcoin Tracker -->
  <div id="matrix-btc-overlay" aria-hidden="true">
    <canvas id="matrix-canvas"></canvas>

    <button class="btc-close-btn" id="close-matrix-btc" aria-label="Close Bitcoin Tracker">Ã—</button>

    <div class="btc-data-container" id="btc-data-container">
      <div class="btc-loading" id="btc-loading">LOADING BTC DATA...</div>

      <div id="btc-content" style="display:none;">
        <div class="btc-main-price" id="btc-main-price">$0.00</div>
        <div class="btc-label">BITCOIN / USD</div>

        <div class="btc-stats-grid">
          <div class="btc-stat-card">
            <div class="btc-stat-label">24h Change</div>
            <div class="btc-stat-value" id="btc-24h-change">+0.00%</div>
          </div>

          <div class="btc-stat-card">
            <div class="btc-stat-label">24h High</div>
            <div class="btc-stat-value" id="btc-24h-high">$0.00</div>
          </div>

          <div class="btc-stat-card">
            <div class="btc-stat-label">24h Low</div>
            <div class="btc-stat-value" id="btc-24h-low">$0.00</div>
          </div>

          <div class="btc-stat-card">
            <div class="btc-stat-label">Market Cap</div>
            <div class="btc-stat-value" id="btc-market-cap">$0.00B</div>
          </div>

          <div class="btc-stat-card">
            <div class="btc-stat-label">24h Volume</div>
            <div class="btc-stat-value" id="btc-volume">$0.00B</div>
          </div>

          <div class="btc-stat-card">
            <div class="btc-stat-label">Last Update</div>
            <div class="btc-stat-value" id="btc-last-update">--:--:--</div>
          </div>
        </div>

        <div class="btc-mini-chart">
          <div class="chart-placeholder">ðŸ“ˆ Live price tracking â€¢ Data from CoinGecko API</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Splash & Tutorial Logic -->
  <script>
    (function() {
      const splash = document.getElementById("splash-overlay");
      const tutorial = document.getElementById("tutorial-overlay");
      const cBtn = document.getElementById("community-site-btn");
      const pBtn = document.getElementById("public-site-btn");
      const skipBtn = document.getElementById("skip-tutorial");
      const box = document.getElementById("dont-show-again");
      const SPLASH_KEY = "chs_splash_seen_once";
      const TUTORIAL_KEY = "chs_tutorial_completed";

      function hideSplash(immediate = false) {
        splash.classList.add("fade-out");
        document.body.classList.remove("splash-active");
        setTimeout(() => {
          splash.style.display = "none";
          checkTutorial();
        }, immediate ? 0 : 600);
      }

      function checkTutorial() {
        if (localStorage.getItem(TUTORIAL_KEY) !== "true") {
          setTimeout(() => tutorial.classList.add("active"), 300);
        } else {
          startDiscovery();
        }
      }

      function dismissSplash() {
        if (box && box.checked) localStorage.setItem(SPLASH_KEY, "true");
        hideSplash();
      }

      function closeTutorial() {
        tutorial.classList.remove("active");
        localStorage.setItem(TUTORIAL_KEY, "true");
        startDiscovery();
      }

      function startDiscovery() {
        setTimeout(() => {
          document.getElementById("discovery-tracker")?.classList.add("visible");
          document.querySelector(".media-container")?.classList.add("idle");
        }, 500);
      }

      window.addEventListener("DOMContentLoaded", () => {
        skipBtn?.addEventListener("click", closeTutorial);

        if (localStorage.getItem(SPLASH_KEY) === "true") {
          hideSplash(true);
          return;
        }

        splash.style.display = "flex";
        document.body.classList.add("splash-active");

        cBtn && (cBtn.onclick = (e) => { e.preventDefault(); dismissSplash(); });
        pBtn && (pBtn.onclick = (e) => {
          e.preventDefault();
          dismissSplash();
          window.location.href = "https://charlestonhacks.mailchimpsites.com/";
        });
      });

      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape" && tutorial?.classList.contains("active")) closeTutorial();
      });
    })();
  </script>

  <!-- Discovery Progress -->
  <script>
    (function() {
      const DISCOVERED_KEY = "chs_discovered_portals";
      const totalPortals = 9;
      const discoveredPortals = new Set(JSON.parse(localStorage.getItem(DISCOVERED_KEY) || "[]"));

      function updateProgress() {
        const count = discoveredPortals.size;
        const pct = (count / totalPortals) * 100;

        const countEl = document.getElementById("portals-count");
        const fillEl = document.getElementById("progress-fill");
        if (countEl) countEl.textContent = String(count);
        if (fillEl) fillEl.style.width = pct + "%";

        if (count === totalPortals) {
          const tracker = document.getElementById("discovery-tracker");
          if (!tracker) return;
          tracker.style.borderColor = "var(--gold)";
          tracker.style.boxShadow = "0 0 30px var(--gold-glow)";
          setTimeout(() => { tracker.style.borderColor = ""; tracker.style.boxShadow = ""; }, 2000);
        }
      }

      function markDiscovered(portalId) {
        if (!portalId) return;
        if (!discoveredPortals.has(portalId)) {
          discoveredPortals.add(portalId);
          localStorage.setItem(DISCOVERED_KEY, JSON.stringify([...discoveredPortals]));
          updateProgress();

          const chime = document.getElementById("chimeSound");
          if (chime) { chime.currentTime = 0; chime.play().catch(() => {}); }
        }
      }

      updateProgress();

      document.querySelectorAll(".clickable-area").forEach((area) => {
        const portalId = area.dataset.portal;
        if (discoveredPortals.has(portalId)) area.classList.add("discovered");
        area.addEventListener("click", () => { markDiscovered(portalId); area.classList.add("discovered"); });
      });

      window.charlestonHacks = { markDiscovered, getProgress: () => discoveredPortals.size };
    })();
  </script>

  <!-- Portal Interactions (single source of truth; no duplicate module init) -->
  <script>
    (function() {
      const infoLine = document.getElementById("infoLine");
      const infoText = document.getElementById("infoText");
      const areas = document.querySelectorAll(".clickable-area");

      // Make buttons keyboard focusable even if CSS resets elsewhere
      areas.forEach(a => a.setAttribute("tabindex", "0"));

      function playSound(id) {
        const el = document.getElementById(id);
        if (!el) return;
        try { el.currentTime = 0; el.play(); } catch (_) {}
      }

      function openMatrixBTC() {
        const overlay = document.getElementById("matrix-btc-overlay");
        if (!overlay) return;
        overlay.classList.add("active");
        overlay.setAttribute("aria-hidden", "false");
        playSound("cardflipSound");
        startMatrixRain();
        fetchBTCData();
      }

      areas.forEach(area => {
        area.addEventListener("mouseenter", () => {
          if (!infoLine || !infoText) return;
          infoText.textContent = area.dataset.info || "";
          infoLine.classList.add("visible");
        });

        area.addEventListener("mouseleave", () => infoLine?.classList.remove("visible"));

        area.addEventListener("click", (e) => {
          e.preventDefault();

          if (area.dataset.portal === "center") {
            openMatrixBTC();
            return;
          }

          const soundKey = area.dataset.sound;
          if (soundKey) playSound(soundKey + "Sound");

          const url = area.dataset.url;
          if (url && url !== "#") setTimeout(() => { window.location.href = url; }, 200);
        });

        area.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") { e.preventDefault(); area.click(); }
        });
      });
    })();
  </script>

  <!-- Matrix BTC Logic -->
  <script>
    let matrixAnimationId = null;

    function startMatrixRain() {
      const canvas = document.getElementById("matrix-canvas");
      if (!canvas) return;

      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      const columns = Math.floor(canvas.width / 20);
      const drops = Array(columns).fill(1);
      const btcChars = "â‚¿$0123456789BITCOIN.";

      function drawMatrix() {
        ctx.fillStyle = "rgba(0, 0, 0, 0.05)";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        ctx.fillStyle = "#00ff00";
        ctx.font = "15px Courier New";

        for (let i = 0; i < drops.length; i++) {
          const text = btcChars[Math.floor(Math.random() * btcChars.length)];
          ctx.fillText(text, i * 20, drops[i] * 20);

          if (drops[i] * 20 > canvas.height && Math.random() > 0.975) drops[i] = 0;
          drops[i]++;
        }
      }

      if (matrixAnimationId) clearInterval(matrixAnimationId);
      matrixAnimationId = setInterval(drawMatrix, 33);

      setTimeout(() => document.getElementById("btc-data-container")?.classList.add("visible"), 1500);
    }

    async function fetchBTCData() {
      const loading = document.getElementById("btc-loading");
      const content = document.getElementById("btc-content");

      try {
        const response = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true&include_24hr_vol=true&include_market_cap=true&include_last_updated_at=true");
        const data = await response.json();

        const detailResponse = await fetch("https://api.coingecko.com/api/v3/coins/bitcoin?localization=false&tickers=false&community_data=false&developer_data=false");
        const detailData = await detailResponse.json();

        if (!data.bitcoin) throw new Error("No bitcoin data returned");

        const btc = data.bitcoin;
        const details = detailData?.market_data || {};

        document.getElementById("btc-main-price").textContent =
          "$" + btc.usd.toLocaleString("en-US", { minimumFractionDigits: 2, maximumFractionDigits: 2 });

        const changePercent = btc.usd_24h_change || 0;
        const changeElem = document.getElementById("btc-24h-change");
        changeElem.textContent = (changePercent >= 0 ? "+" : "") + changePercent.toFixed(2) + "%";
        changeElem.className = "btc-stat-value " + (changePercent >= 0 ? "positive" : "negative");

        document.getElementById("btc-24h-high").textContent =
          "$" + (details.high_24h?.usd || 0).toLocaleString("en-US", { minimumFractionDigits: 2, maximumFractionDigits: 2 });

        document.getElementById("btc-24h-low").textContent =
          "$" + (details.low_24h?.usd || 0).toLocaleString("en-US", { minimumFractionDigits: 2, maximumFractionDigits: 2 });

        const marketCap = btc.usd_market_cap || 0;
        document.getElementById("btc-market-cap").textContent = "$" + (marketCap / 1e9).toFixed(2) + "B";

        const volume = btc.usd_24h_vol || 0;
        document.getElementById("btc-volume").textContent = "$" + (volume / 1e9).toFixed(2) + "B";

        const updateTime = new Date((btc.last_updated_at || 0) * 1000);
        document.getElementById("btc-last-update").textContent =
          updateTime.toLocaleTimeString("en-US", { hour: "2-digit", minute: "2-digit", second: "2-digit" });

        setTimeout(() => {
          if (loading) loading.style.display = "none";
          if (content) content.style.display = "block";
        }, 800);

      } catch (err) {
        console.error("Error fetching BTC data:", err);
        if (loading) loading.textContent = "ERROR LOADING DATA";
        setTimeout(() => {
          if (loading) loading.style.display = "none";
          if (content) content.style.display = "block";
          document.getElementById("btc-main-price").textContent = "DATA UNAVAILABLE";
        }, 1000);
      }
    }

    function closeMatrixBTC() {
      const overlay = document.getElementById("matrix-btc-overlay");
      overlay?.classList.remove("active");
      overlay?.setAttribute("aria-hidden", "true");

      if (matrixAnimationId) { clearInterval(matrixAnimationId); matrixAnimationId = null; }

      setTimeout(() => {
        document.getElementById("btc-data-container")?.classList.remove("visible");
        const loading = document.getElementById("btc-loading");
        const content = document.getElementById("btc-content");
        if (loading) { loading.style.display = "block"; loading.textContent = "LOADING BTC DATA..."; }
        if (content) content.style.display = "none";

        const canvas = document.getElementById("matrix-canvas");
        if (canvas) canvas.getContext("2d")?.clearRect(0, 0, canvas.width, canvas.height);
      }, 250);
    }

    document.getElementById("close-matrix-btc")?.addEventListener("click", closeMatrixBTC);

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") closeMatrixBTC();
    });

    document.getElementById("matrix-btc-overlay")?.addEventListener("click", (e) => {
      if (e.target && e.target.id === "matrix-btc-overlay") closeMatrixBTC();
    });

    // expose for the portal handler (safe)
    window.fetchBTCData = fetchBTCData;
    window.startMatrixRain = startMatrixRain;
  </script>

  <!-- Core modules + Auth gate (prevents refresh redirect to dashboard by persisting intent) -->
  <script type="module">
    import "/assets/js/neuralBackground.js";
    import { supabase } from "/assets/js/supabaseClient.js";

    // Gate: prevent auth overlay/routing race on refresh
    window.__CH_AUTH_READY__ = false;

    try {
      const { data: { session } } = await supabase.auth.getSession();

      // Persist the current page as "lastScreen" so a global router can honor it.
      // (This solves: refresh on screen 1 -> stay on screen 1, instead of bouncing to screen 2.)
      localStorage.setItem("ch:lastScreen", "index");

      // Mark ready either way (session or no session)
      window.__CH_AUTH_READY__ = true;

      // Optional: expose session for debugging
      window.__CH_SESSION__ = session || null;
    } catch (e) {
      console.warn("Auth gate session check failed:", e);
      window.__CH_AUTH_READY__ = true;
    }
  </script>

  <!-- EventsFeed loader (keeps your improved async import pattern) -->
  <script type="module">
    async function loadEventsFeedWhenReady() {
      while (!document.getElementById("events-list")) {
        await new Promise(r => setTimeout(r, 40));
      }

      try {
        const module = await import("/assets/js/eventsFeed.js");
        if (module.loadEvents) window.loadEvents = module.loadEvents;
      } catch (error) {
        console.error("Failed to import eventsFeed.js:", error);
      }
    }

    window.addEventListener("DOMContentLoaded", loadEventsFeedWhenReady);
  </script>

  <!-- Modal Controls -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const openCalendarBtn = document.getElementById("open-calendar");
      const eventsOverlay = document.getElementById("events-overlay");
      const closeBtn = document.getElementById("close-overlay");

      if (openCalendarBtn && eventsOverlay) {
        openCalendarBtn.addEventListener("click", (e) => {
          e.preventDefault();
          eventsOverlay.classList.add("active");

          if (typeof window.loadEvents === "function") {
            window.loadEvents();
          } else {
            setTimeout(() => typeof window.loadEvents === "function" && window.loadEvents(), 500);
          }
        });
      }

      if (closeBtn && eventsOverlay) {
        closeBtn.addEventListener("click", () => eventsOverlay.classList.remove("active"));
      }

      eventsOverlay?.addEventListener("click", (e) => {
        if (e.target === eventsOverlay) eventsOverlay.classList.remove("active");
      });
    });
  </script>
</body>
</html>
