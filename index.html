<!DOCTYPE html>
<html lang="en-US">
<head>
  <!-- —— Neuron redirect —— -->
  <script>
    const params = new URLSearchParams(window.location.search);
    if (params.get("source") === "neuron") {
      window.location.href = "/neural.html?" + params.toString();
    }
  </script>

  <!-- —— Google Analytics —— -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-6NDKG07DY6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag("js", new Date());
    gtag("config", "G-6NDKG07DY6");
  </script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>CharlestonHacks - Home</title>
  <meta name="description" content="Join CharlestonHacks for transformative hackathons and tech meetups in Charleston, SC." />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="stylesheet" href="styles.css" />
  <meta name="theme-color" content="#ff6600" />
</head>

<body>
  <!-- —— Neural background —— -->
  <canvas id="neural-bg"></canvas>

  <noscript>
    <div style="background:#111;color:white;text-align:center;padding:1em;">
      ⚠️ JavaScript is disabled. Please enable JavaScript.
    </div>
  </noscript>

  <!-- —— Splash screen —— -->
  <div id="splash-overlay">
    <div id="splash-content">
      <img id="splash-logo" src="images/charlestonhackslogo.svg" alt="CharlestonHacks Logo" />
      <h1 id="splash-title">Welcome to CharlestonHacks</h1>
      <p>Loading…</p>
      <label style="margin-top:1em;display:flex;align-items:center;gap:.5em;">
        <input type="checkbox" id="dont-show-again" /> Don’t show this again
      </label>
      <div class="button-container">
        <button id="community-site-btn" class="btn">Community Site</button>
        <button id="public-site-btn" class="btn">Public Site</button>
      </div>
      <p style="font-size:.8rem;opacity:.7;margin-top:2rem;">
        © 2025 CharlestonHacks. All rights reserved.
      </p>
    </div>
  </div>

  <!-- —— Audio —— -->
  <audio id="cardflipSound" src="assets/atmospherel.m4a" preload="auto"></audio>
  <audio id="chimeSound" src="assets/chime.mp3" preload="auto"></audio>
  <audio id="keysSound" src="assets/keys.m4a" preload="auto"></audio>

  <!-- —— Main card —— -->
  <main>
    <div class="main-wrapper">
      <div class="media-container" tabindex="0">
        <div id="countdown"></div>
        <div id="btcPrice"></div>

        <img id="missionImage" src="icons/card.png" alt="Big Playing Card" />
        <img id="cardFrame" src="images/cardframe2.svg" alt="Card Frame" style="display:none;" />
        <video id="missionVideo" muted playsinline controls style="display:none;opacity:0;">
          <source src="" type="video/mp4" />
        </video>

        <!-- Clickable buttons -->
        <button type="button" class="clickable-area top-left" data-sound="chime" data-url="Poster.html" data-info="Event poster">
          <img src="images/informationbutton.webp" alt="Info" />
        </button>
        <button type="button" class="clickable-area top-center" data-sound="chime" data-url="docs.html" data-info="Docs & resources">
          <img src="images/crestn.svg" alt="Docs" />
        </button>
        <button type="button" class="clickable-area top-right" data-sound="chime" data-url="2card.html" data-info="Innovation engine">
          <img src="images/innovationenginebutton.webp" alt="Innovation" />
        </button>
        <button type="button" class="clickable-area middle-left" data-sound="chime" data-url="experimental.html" data-info="Sandbox">
          <img src="images/experiment.webp" alt="Experiment" />
        </button>
        <button type="button" class="clickable-area middle-right" data-sound="chime" data-url="swag.html" data-info="Event swag">
          <img src="images/case.webp" alt="Swag" />
        </button>
        <button type="button" class="clickable-area bottom-left" data-sound="chime" data-url="news.html" data-info="Latest news">
          <img src="images/newsbutton.webp" alt="News" />
        </button>
        <button type="button" class="clickable-area bottom-center" data-sound="keys" data-url="donations.html" data-info="Sponsor">
          <img src="images/keysn.svg" alt="Keys" />
        </button>
        <button type="button" class="clickable-area bottom-right" data-sound="chime" data-url="cardmatchgame.html" data-info="Card Match Game">
          <img src="images/peoplebutton.webp" alt="People" />
        </button>

        <div id="infoLine"><span id="infoText"></span></div>
      </div>
    </div>

    <!-- —— Sidebar Icons (now includes Discord) —— -->
    <section class="icons-container">
      <a href="https://github.com/sponsors/deckerd451" target="_blank" aria-label="Sponsor"><i class="fas fa-heart"></i></a>
      <a href="2card.html" aria-label="Innovation Engine"><i class="fas fa-people-arrows"></i></a>
      <a href="subscribe.html" aria-label="Subscribe"><i class="fas fa-bell"></i></a>
      <a href="#" id="chat-launch" aria-label="Join Discord Chat"><i class="fab fa-discord"></i></a>
      <a href="https://www.linkedin.com/company/charlestonhacks" target="_blank"><i class="fab fa-linkedin"></i></a>
      <a href="https://www.instagram.com/charlestonhacks/" target="_blank"><i class="fab fa-instagram"></i></a>
      <a href="mailto:hello@charlestonhacks.com"><i class="fas fa-envelope"></i></a>
      <a href="https://www.facebook.com/deckerdb26354" target="_blank"><i class="fab fa-facebook"></i></a>
    </section>
  </main>

  <!-- —— Scripts —— -->
  <script type="module">
    import { CONFIG } from "./assets/js/config.js";
    import { initCardFlip } from "./assets/js/cardFlip.js";
    import { startBTCPriceTracker } from "./assets/js/btc.js";
    import { startCountdown } from "./assets/js/countdown.js";
    import { setupChatBubble } from "./assets/js/chatBubble.js";

    CONFIG.sounds = {
      cardflip: document.getElementById("cardflipSound"),
      chime: document.getElementById("chimeSound"),
      keys: document.getElementById("keysSound"),
    };

    initCardFlip(CONFIG);
    startBTCPriceTracker("btcPrice");
    startCountdown("countdown", "2025-10-03T00:00:00-04:00");
    setupChatBubble();

    // Clickable areas
    const buttons = document.querySelectorAll(".clickable-area");
    const infoLine = document.getElementById("infoLine");
    const infoText = document.getElementById("infoText");

    buttons.forEach(btn => {
      btn.addEventListener("click", e => {
        e.stopPropagation();
        const sound = document.getElementById(btn.dataset.sound + "Sound");
        if (sound) sound.play();
        if (btn.dataset.url) setTimeout(() => (window.location.href = btn.dataset.url), 400);
      });
      btn.addEventListener("mouseover", () => {
        infoLine.style.opacity = "1";
        infoText.textContent = btn.dataset.info || "";
      });
      btn.addEventListener("mouseout", () => {
        infoLine.style.opacity = "0";
        infoText.textContent = "";
      });
    });

    // Discord chat icon opens chat
    document.getElementById("chat-launch").addEventListener("click", e => {
      e.preventDefault();
      const bubble = document.getElementById("discord-bubble");
      if (bubble) bubble.classList.add("visible");
    });
  </script>

  <!-- —— Neural background —— -->
  <script type="module" src="assets/js/neuralBackground.js"></script>

  <!-- —— Silence WidgetBot CORS noise —— -->
  <script>
    (function () {
      const orig = console.error ? console.error.bind(console) : null;
      if (!orig) return;
      console.error = (...args) => {
        if (args.some(a => typeof a === "string" && a.includes("bugs.widgetbot.co"))) return;
        orig(...args);
      };
    })();
  </script>
</body>
</html>
