<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>CharlestonHacks Matching Game</title>
  <style>
    body {
      min-height: 100vh;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      position: relative;
      transition: background 0.5s, color 0.5s;
    }
    body::before {
      content: "";
      position: fixed;
      z-index: -1;
      top: 0; left: 0; right: 0; bottom: 0;
      width: 100vw; height: 100vh;
      background: var(--bg-url, url('images/background.jpg')) no-repeat center center;
      background-size: cover;
      background-attachment: scroll;
      transition: background 0.5s;
    }
    /* Clickable Logo */
    .logo-link {
      display: inline-block;
      margin-top: 20px;
      transition: transform 0.3s ease, filter 0.3s ease;
    }
    .logo-link:hover {
      transform: scale(1.05);
      filter: drop-shadow(0 0 10px #39FF14);
    }
    .logo {
      width: 400px;
      height: auto;
    }

    .game-container {
      display: grid;
      grid-template-columns: repeat(4, 220px);
      grid-template-rows: repeat(4, 308px);
      gap: 28px;
      justify-content: center;
      margin-top: 50px;
    }
    .card {
      width: 100%;
      max-width: 220px;
      height: 308px;
      perspective: 1000px;
      cursor: pointer;
      aspect-ratio: 5/7;
    }
    .card-inner {
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.5s;
    }
    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }
    .card-front, .card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
    }
    .card-front {
      background-color: #ddd;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      color: #000;
    }
    .card-back {
      background-color: #333;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      transform: rotateY(180deg);
    }
    .card-back img, .card-front img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .backstory {
      display: flex;
      justify-content: center;
      align-items: center;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #222;
      padding: 20px;
      border-radius: 5px;
      font-size: 16px;
      max-width: 90%;
      max-height: 80%;
      overflow-y: auto;
      display: none;
    }

    /* MODAL */
    .modal-overlay {
      display: none;
      position: fixed;
      z-index: 2000;
      left: 0; top: 0;
      width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.85);
      justify-content: center;
      align-items: center;
    }
    .modal-overlay.active {
      display: flex;
    }
    .modal-content {
      background: #181818;
      color: #fff;
      border-radius: 16px;
      padding: 36px 28px 28px 28px;
      box-shadow: 0 8px 40px #39FF1440;
      min-width: 280px;
      max-width: 90vw;
      text-align: center;
      position: relative;
    }
    .modal-content h2 {
      color: #39FF14;
      margin-top: 0;
      font-size: 2rem;
      margin-bottom: 10px;
    }
    .modal-content p {
      font-size: 1.1rem;
      margin: 0 0 18px 0;
    }
    .modal-btn, #profiles-btn {
      padding: 14px 32px;
      font-size: 1.1rem;
      font-weight: 700;
      background: linear-gradient(90deg,#39FF14 0%, #89CFF0 100%);
      color: #212121;
      border: none;
      border-radius: 30px;
      box-shadow: 0 4px 16px #39FF1440;
      cursor: pointer;
      transition: background 0.2s, color 0.2s, transform 0.15s;
      margin: 0 14px;
      margin-top: 18px;
    }
    .modal-btn:hover, #profiles-btn:hover {
      background: linear-gradient(90deg,#89CFF0 0%, #39FF14 100%);
      color: #000;
      transform: scale(1.06);
    }
    .modal-close {
      position: absolute;
      top: 10px; right: 18px;
      font-size: 2rem;
      color: #fff;
      background: none;
      border: none;
      cursor: pointer;
      transition: color 0.18s;
    }
    .modal-close:hover { color: #39FF14; }

    /* Footer */
    footer {
      background: transparent;
      margin-top: auto;
      text-align: center;
      padding: 32px 20px 64px;
      position: relative;
    }
    .footer-icons {
      list-style: none;
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 10px;
      padding: 0;
    }
    .footer-icons a {
      color: #89CFF0;
      font-size: 18px;
      transition: color 0.3s ease;
    }
    .footer-icons a:hover {
      color: #FF6347;
    }
    .footer-back-button img {
      max-width: 240px;
      width: 60vw;
      height: auto;
      transition: transform 0.3s ease;
    }
    .footer-back-button img:hover {
      transform: scale(1.05);
    }
    #theme-toggle {
      display: inline-block;
      margin: 20px auto 10px auto;
      font-size: 18px;
      color: #89CFF0;
      background: none;
      border: none;
      cursor: pointer;
      text-decoration: underline;
      transition: color 0.3s;
    }
    #theme-toggle:hover {
      color: #FF6347;
    }

    @media (max-width: 800px) {
      .game-container {
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        padding: 10px;
        max-width: 90vw;
        margin: 20px auto;
      }
      .logo { width: 300px; margin-top: 10px; }
    }
    @media (max-width: 480px) {
      .game-container { gap: 8px; padding: 8px; }
      .logo { width: 200px; }
    }
  </style>
</head>

<!-- Google tag -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6NDKG07DY6"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-6NDKG07DY6');
</script>

<body>

<!-- ✅ Clickable logo at top -->
<a href="index.html" class="logo-link">
  <img src="images/about us dark.webp" alt="CharlestonHacks Logo" class="logo">
</a>

<div class="stats">
  <span id="timer">Time: 0s</span>
  <span id="moves">Moves: 0</span>
</div>

<div class="game-container" id="game-container"></div>
<div class="backstory" id="backstory"></div>

<!-- Victory Modal -->
<div class="modal-overlay" id="victory-modal">
  <div class="modal-content">
    <button class="modal-close" id="modal-close-btn" aria-label="Close Modal">&times;</button>
    <h2>Congratulations!</h2>
    <p id="victory-message"></p>
    <button class="modal-btn" id="play-again-btn">Play Again</button>
    <button class="modal-btn" id="profiles-btn">View Team Profiles</button>
  </div>
</div>

<div id="video-container">
  <button id="close-video">X</button>
  <video id="video" controls muted>
    <source id="video-source" type="video/mp4">
  </video>
</div>

<footer>
  <ul class="footer-icons">
    <li><a href="https://www.instagram.com/charlestonhacks/" target="_blank"><i class="fab fa-instagram"></i></a></li>
    <li><a href="mailto:hello@charlestonhacks.com"><i class="fas fa-envelope"></i></a></li>
    <li><a href="https://www.linkedin.com/company/charlestonhacks" target="_blank"><i class="fab fa-linkedin"></i></a></li>
    <li><a href="https://twitter.com/Descart84114619" target="_blank"><i class="fab fa-twitter"></i></a></li>
  </ul>
  <div class="footer-back-button">
    <a href="index.html"><img src="assets/chbackbuttonred.png" alt="Back to Home"></a>
  </div>
  <button id="theme-toggle" type="button">Toggle Theme</button>
  <p>Background music "background music.mp3" by ZHRØ —
    <a href="https://freesound.org/s/544416/" target="_blank">Link</a> — License: Attribution 4.0
  </p>
  <p style="margin-top: 16px; font-size: 16px;">© 2025 CharlestonHacks. All rights reserved.</p>
</footer>

<audio id="background-music" autoplay loop>
  <source src="assets/music.mp3" type="audio/mp3">
</audio>
<audio id="victory-sound" src="assets/chime.mp3" preload="auto"></audio>

<script>
(function () {
  // --- THEME LOGIC ---
  const THEME_KEY = "chhacks_theme";
  const themeToggle = document.getElementById('theme-toggle');
  const themeSound = new Audio('assets/viramiller.mp3');
  function applyTheme(theme) {
    document.body.classList.toggle('light-theme', theme === 'light');
    document.body.style.setProperty('--bg-url',
      theme === 'light' ? "url('images/background-light.jpg')" : "url('images/background.jpg')");
    const logoImg = document.querySelector('.logo');
    if (logoImg) logoImg.src = theme === 'light'
      ? 'images/about us light.webp'
      : 'images/about us dark.webp';
  }
  let currentTheme = localStorage.getItem(THEME_KEY) ||
    (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
  document.addEventListener('DOMContentLoaded', () => applyTheme(currentTheme));
  themeToggle.addEventListener('click', () => {
    currentTheme = currentTheme === 'light' ? 'dark' : 'light';
    localStorage.setItem(THEME_KEY, currentTheme);
    applyTheme(currentTheme);
    themeSound.play();
  });

  // --- GAME LOGIC ---
  const characters = ['astrid','medusa','alexandor','aegis','descartes','elara','wolf','hermes','merlin','mystery'];
  const backstories = {
    'astrid':'Astrid - A Valkyrie...',
    'medusa':'Medusa - ...',
    'alexandor':'Alexandor - ...',
    'aegis':'Aegis - ...',
    'descartes':'Descartes - ...',
    'elara':'Elara - ...',
    'wolf':'Wolf - ...',
    'hermes':'Hermes - ...',
    'merlin':'Merlin - ...',
    'mystery':'? - A Mystery...'
  };
  const gameContainer=document.getElementById('game-container');
  const backstoryContainer=document.getElementById('backstory');
  const timerDisplay=document.getElementById('timer');
  const movesDisplay=document.getElementById('moves');
  const victoryModal=document.getElementById('victory-modal');
  const victoryMessage=document.getElementById('victory-message');
  const playAgainBtn=document.getElementById('play-again-btn');
  const profilesBtn=document.getElementById('profiles-btn');
  const modalCloseBtn=document.getElementById('modal-close-btn');
  let flippedCards=[], matchedCards=[], timer=0, moves=0, intervalId;

  function startTimer(){intervalId=setInterval(()=>{timer++;timerDisplay.textContent=`Time: ${timer}s`;},1000);}
  function stopTimer(){clearInterval(intervalId);}
  function createCards(){
    const cards=[];
    characters.forEach(c=>{
      for(let i=0;i<2;i++){
        const card=document.createElement('div');
        card.classList.add('card');
        card.dataset.character=c;
        card.innerHTML=`
          <div class="card-inner">
            <div class="card-front"><img src="images/universalcard-01.png"></div>
            <div class="card-back"><img src="images/${c.charAt(0).toUpperCase()+c.slice(1)}.png"></div>
          </div>`;
        cards.push(card);
      }
    });
    return cards;
  }
  function shuffleCards(){
    const cards=createCards();
    cards.sort(()=>Math.random()-0.5);
    gameContainer.innerHTML='';
    cards.forEach(c=>gameContainer.appendChild(c));
  }
  function showVictoryModal(){
    victoryMessage.textContent=`You win! Time: ${timer}s, Moves: ${moves}`;
    victoryModal.classList.add('active');
  }
  gameContainer.addEventListener('click',e=>{
    const card=e.target.closest('.card');
    if(!card||card.classList.contains('flipped')||flippedCards.length>=2)return;
    card.classList.add('flipped');
    flippedCards.push(card);
    moves++;
    movesDisplay.textContent=`Moves: ${moves}`;
    if(flippedCards.length===2){
      const[first,second]=flippedCards;
      if(first.dataset.character===second.dataset.character){
        matchedCards.push(first,second);
        backstoryContainer.textContent=backstories[first.dataset.character];
        backstoryContainer.style.display='block';
        flippedCards=[];
        if(matchedCards.length===characters.length*2){stopTimer();showVictoryModal();}
      } else {
        setTimeout(()=>{first.classList.remove('flipped');second.classList.remove('flipped');flippedCards=[];},1000);
      }
    }
  });
  playAgainBtn.addEventListener('click',()=>{
    victoryModal.classList.remove('active');
    matchedCards=[];flippedCards=[];timer=0;moves=0;
    timerDisplay.textContent='Time: 0s';movesDisplay.textContent='Moves: 0';
    backstoryContainer.style.display='none';
    shuffleCards();stopTimer();startTimer();
  });
  modalCloseBtn.addEventListener('click',()=>victoryModal.classList.remove('active'));
  profilesBtn.addEventListener('click',()=>window.location.href='profiles.html');
  shuffleCards();startTimer();
})();
</script>
</body>
</html>
