/**
 * MOBILE V3 - CLEAN & SIMPLE
 * Drastically simplified mobile experience
 * Fixes visual artifacts and clutter
 * Last updated: 2026-03-01
 */

/* ============================================================================
   CRITICAL: HIDE ALL ARTIFACTS AND CLUTTER
   ============================================================================ */

@media (max-width: 1023px) {
  
  /* ── Hide all top decorative elements that cause artifacts ──────────────── */
  #main-content > div:first-child,
  #main-content > div:nth-child(2),
  .top-actions,
  .header-badges,
  .engagement-displays,
  #engagement-displays,
  .stat-card-mini,
  .unified-header,
  #desktop-top-left-actions {
    display: none !important;
  }
  
  /* ── Hide command dashboard completely ──────────────────────────────────── */
  #command-dashboard,
  #cd-panel-tab,
  .cd-mobile-panel {
    display: none !important;
  }
  
  /* ── HIDE LEGEND ON MOBILE ───────────────────────────────────────────── */
  #graph-legend,
  .graph-legend,
  .legend,
  .legend-panel,
  [class*="legend"],
  [id*="legend"] {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
  }
  
  /* ── HIDE COMPETING LOADING STATES ───────────────────────────────────── */
  .loading,
  .loader,
  .spinner,
  .loading-spinner,
  .loading-overlay,
  .loading-indicator,
  [class*="loading"],
  [class*="spinner"],
  [class*="loader"],
  [id*="loading"],
  [id*="spinner"],
  [id*="loader"] {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
  }
  
  /* Keep only the main loading state if needed */
  #main-loading {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }
  
  /* ── Hide any floating UI elements that cause clutter ───────────────────── */
  .floating-badge,
  .corner-badge,
  .top-badge,
  [style*="position:absolute"][style*="top:20px"],
  [style*="position:fixed"][style*="top:20px"]:not(#mobile-top-bar) {
    display: none !important;
  }

}

/* ============================================================================
   FOUNDATION - CLEAN SLATE
   ============================================================================ */

@media (max-width: 1023px) {
  
  /* ── Reset everything ────────────────────────────────────────────────── */
  * {
    -webkit-tap-highlight-color: rgba(0, 224, 255, 0.2);
  }
  
  /* ── Viewport ────────────────────────────────────────────────────────── */
  :root {
    --mobile-vh: 100vh;
    --safe-top: env(safe-area-inset-top, 0px);
    --safe-bottom: env(safe-area-inset-bottom, 0px);
  }
  
  @supports (height: 100dvh) {
    :root {
      --mobile-vh: 100dvh;
    }
  }
  
  /* ── Body ────────────────────────────────────────────────────────────── */
  html,
  body {
    width: 100%;
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden;
    position: fixed;
    background: #000;
  }
  
  /* ── Main container ──────────────────────────────────────────────────── */
  #main-content,
  .unified-main {
    position: fixed !important;
    inset: 0 !important;
    width: 100% !important;
    height: 100% !important;
    overflow: hidden !important;
    background: #000 !important;
  }
  
  /* ── Background ──────────────────────────────────────────────────────── */
  #neural-bg,
  canvas {
    pointer-events: none !important;
    z-index: -1 !important;
  }
  
  /* ── Graph container ─────────────────────────────────────────────────── */
  #synapse-main-view {
    position: absolute !important;
    inset: 0 !important;
    width: 100% !important;
    height: 100% !important;
    left: 0 !important;
    right: 0 !important;
    z-index: 1 !important;
    overflow: hidden !important;
  }
  
  #synapse-svg {
    width: 100% !important;
    height: 100% !important;
    touch-action: pan-x pan-y pinch-zoom !important;
    overflow: visible !important;
  }
  
  /* ── Lock viewport to prevent nodes from being cut off ──────────────────── */
  #synapse-svg g {
    transform-origin: center center !important;
  }
  
  /* Ensure nodes stay within viewport */
  #synapse-svg circle,
  #synapse-svg .node {
    vector-effect: non-scaling-stroke !important;
  }
  
  /* ── HIDE ALL CONNECTION LINES ON MOBILE ─────────────────────────────── */
  /* Proximity will show connections instead */
  #synapse-svg line,
  #synapse-svg path[stroke],
  #synapse-svg .link,
  #synapse-svg .connection,
  #synapse-svg .edge {
    display: none !important;
    opacity: 0 !important;
    visibility: hidden !important;
  }
  
  /* Keep nodes visible */
  #synapse-svg circle,
  #synapse-svg .node {
    display: block !important;
    opacity: 1 !important;
    visibility: visible !important;
  }

}

/* ============================================================================
   MOBILE TOP BAR - CLEAN AND SIMPLE
   ============================================================================ */

@media (max-width: 1023px) {
  
  /* Create a clean top bar */
  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    height: calc(var(--safe-top) + 60px);
    background: linear-gradient(180deg, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0.7) 70%, transparent 100%);
    z-index: 9997;
    pointer-events: none;
  }
  
  /* ── Top button container ────────────────────────────────────────────── */
  #mobile-top-bar {
    position: fixed !important;
    top: calc(var(--safe-top) + 8px) !important;
    right: 12px !important;
    display: flex !important;
    gap: 8px !important;
    z-index: 9999 !important;
    pointer-events: auto !important;
  }
  
  /* ── Top buttons ─────────────────────────────────────────────────────── */
  #btn-refresh-network,
  #btn-logout-header {
    width: 44px !important;
    height: 44px !important;
    min-width: 44px !important;
    min-height: 44px !important;
    padding: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    border-radius: 50% !important;
    background: rgba(0, 0, 0, 0.8) !important;
    backdrop-filter: blur(10px) !important;
    border: 1px solid rgba(0, 224, 255, 0.3) !important;
    pointer-events: auto !important;
    touch-action: manipulation !important;
    cursor: pointer !important;
    z-index: 10000 !important;
  }
  
  #btn-refresh-network i,
  #btn-logout-header i {
    font-size: 1.1rem !important;
    color: #00e0ff !important;
    pointer-events: none !important;
  }
  
  #btn-logout-header i {
    color: #ff6b6b !important;
  }

}

/* ============================================================================
   SEARCH BAR - BOTTOM CENTER, CLEAN
   ============================================================================ */

@media (max-width: 1023px) {
  
  /* ── Search container ────────────────────────────────────────────────── */
  #centered-search-container {
    position: fixed !important;
    bottom: calc(var(--safe-bottom) + 80px) !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    width: calc(100% - 32px) !important;
    max-width: 500px !important;
    z-index: 9998 !important;
    pointer-events: auto !important;
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
  }
  
  /* Hide category buttons on mobile */
  #category-action-bar {
    display: none !important;
  }
  
  .search-category-btn {
    display: none !important;
  }
  
  #search-container {
    width: 100% !important;
    background: rgba(0, 0, 0, 0.9) !important;
    backdrop-filter: blur(20px) !important;
    border: 1px solid rgba(0, 224, 255, 0.3) !important;
    border-radius: 25px !important;
    padding: 8px !important;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5) !important;
  }
  
  /* ── Search input ────────────────────────────────────────────────────── */
  #global-search {
    width: 100% !important;
    height: 44px !important;
    padding: 0 60px 0 44px !important;
    font-size: 16px !important;
    background: transparent !important;
    border: none !important;
    color: #fff !important;
    pointer-events: auto !important;
  }
  
  #global-search::placeholder {
    color: rgba(255, 255, 255, 0.5) !important;
  }
  
  /* ── Search icon ─────────────────────────────────────────────────────── */
  #search-container .fa-search {
    position: absolute !important;
    left: 18px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    color: #00e0ff !important;
    pointer-events: none !important;
  }
  
  /* ── Search button ───────────────────────────────────────────────────── */
  #search-button {
    position: absolute !important;
    right: 8px !important;
    top: 50% !important;
    transform: translateY(-50%) !important;
    height: 36px !important;
    padding: 0 16px !important;
    border-radius: 18px !important;
    background: linear-gradient(135deg, #00e0ff, #0080ff) !important;
    border: none !important;
    color: #fff !important;
    font-weight: 600 !important;
    pointer-events: auto !important;
    touch-action: manipulation !important;
    cursor: pointer !important;
  }
  
  /* ── Hide drag handle ────────────────────────────────────────────────── */
  #search-drag-handle {
    display: none !important;
  }
  
  /* ── Search suggestions ──────────────────────────────────────────────── */
  #search-suggestions {
    position: absolute !important;
    bottom: calc(100% + 8px) !important;
    left: 0 !important;
    right: 0 !important;
    max-height: 50vh !important;
    background: rgba(0, 0, 0, 0.95) !important;
    backdrop-filter: blur(20px) !important;
    border: 1px solid rgba(0, 224, 255, 0.3) !important;
    border-radius: 16px !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
    z-index: 9999 !important;
  }

}

/* ============================================================================
   BUTTONS - GUARANTEED TO WORK
   ============================================================================ */

@media (max-width: 1023px) {
  
  button,
  .btn,
  [role="button"],
  a {
    pointer-events: auto !important;
    touch-action: manipulation !important;
    cursor: pointer !important;
    min-width: 44px !important;
    min-height: 44px !important;
    position: relative !important;
    z-index: 100 !important;
  }
  
  /* Button children don't block clicks */
  button *,
  .btn *,
  [role="button"] * {
    pointer-events: none !important;
  }
  
  /* Inputs */
  input,
  textarea,
  select {
    pointer-events: auto !important;
    font-size: 16px !important;
    min-height: 44px !important;
  }

}

/* ============================================================================
   LOGIN SCREEN - CLEAN AND SIMPLE
   ============================================================================ */

@media (max-width: 1023px) {
  
  #login-section {
    padding: calc(var(--safe-top) + 1rem) 1rem calc(var(--safe-bottom) + 1rem) !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
  }
  
  .login-container {
    width: 100% !important;
    max-width: 400px !important;
    margin: 0 auto !important;
  }
  
  .login-container img {
    max-width: 240px !important;
    margin: 0 auto !important;
    display: block !important;
  }
  
  .login-container h2 {
    font-size: 1.25rem !important;
    text-align: center !important;
  }
  
  .login-container p {
    font-size: 0.95rem !important;
    text-align: center !important;
  }
  
  /* Hide feature grid on mobile */
  .login-container > div[style*="grid-template-columns"] {
    display: none !important;
  }
  
  /* OAuth buttons */
  .oauth-btn,
  #github-login,
  #google-login,
  #email-login-btn {
    width: 100% !important;
    height: 52px !important;
    min-height: 52px !important;
    padding: 0 20px !important;
    font-size: 16px !important;
    margin-bottom: 12px !important;
  }
  
  /* Email inputs */
  #email-input,
  #password-input {
    width: 100% !important;
    height: 48px !important;
    padding: 0 16px !important;
    font-size: 16px !important;
    box-sizing: border-box !important;
  }

}

/* ============================================================================
   MODALS - FULL SCREEN, CLEAN
   ============================================================================ */

@media (max-width: 1023px) {
  
  .modal,
  .ch-modal-overlay,
  #messages-modal,
  #admin-panel,
  #profile-modal,
  .connection-requests-panel,
  .node-panel,
  #node-side-panel {
    position: fixed !important;
    inset: 0 !important;
    width: 100% !important;
    height: 100% !important;
    max-width: 100% !important;
    max-height: 100% !important;
    border-radius: 0 !important;
    margin: 0 !important;
    z-index: 10000 !important;
    background: #000 !important;
  }
  
  .modal-content,
  .ch-modal-panel {
    width: 100% !important;
    height: 100% !important;
    max-width: 100% !important;
    max-height: 100% !important;
    border-radius: 0 !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
    padding-top: calc(var(--safe-top) + 60px) !important;
    padding-bottom: calc(var(--safe-bottom) + 20px) !important;
  }
  
  /* Close button */
  .modal-close,
  .ch-modal-close,
  .close-btn {
    position: fixed !important;
    top: calc(var(--safe-top) + 8px) !important;
    right: 12px !important;
    width: 44px !important;
    height: 44px !important;
    min-width: 44px !important;
    min-height: 44px !important;
    z-index: 10001 !important;
    background: rgba(0, 0, 0, 0.8) !important;
    border-radius: 50% !important;
    border: 1px solid rgba(255, 107, 107, 0.3) !important;
  }

}

/* ============================================================================
   NOTIFICATIONS - TOP CENTER
   ============================================================================ */

@media (max-width: 1023px) {
  
  .xp-notification,
  .unified-network-notification,
  .toast,
  .notification {
    position: fixed !important;
    top: calc(var(--safe-top) + 70px) !important;
    left: 16px !important;
    right: 16px !important;
    width: auto !important;
    max-width: calc(100% - 32px) !important;
    z-index: 10001 !important;
  }

}

/* ============================================================================
   BOTTOM NAVIGATION - CLEAN
   ============================================================================ */

@media (max-width: 1023px) {
  
  /* Create bottom nav gradient */
  body::after {
    content: '';
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: calc(var(--safe-bottom) + 100px);
    background: linear-gradient(0deg, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0.7) 50%, transparent 100%);
    z-index: 9997;
    pointer-events: none;
  }
  
  /* ── Mobile Bottom Navigation Bar ────────────────────────────────────── */
  #mobile-bottom-nav {
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    height: calc(var(--safe-bottom) + 60px) !important;
    background: rgba(0, 0, 0, 0.95) !important;
    backdrop-filter: blur(20px) !important;
    border-top: 1px solid rgba(0, 224, 255, 0.2) !important;
    display: flex !important;
    align-items: center !important;
    justify-content: space-around !important;
    padding-bottom: var(--safe-bottom) !important;
    z-index: 9999 !important;
    pointer-events: auto !important;
  }
  
  /* ── Bottom nav buttons ──────────────────────────────────────────────── */
  .mobile-nav-btn {
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 4px !important;
    padding: 8px 16px !important;
    min-width: 60px !important;
    min-height: 52px !important;
    color: rgba(255, 255, 255, 0.6) !important;
    text-decoration: none !important;
    border-radius: 12px !important;
    transition: all 0.2s !important;
    pointer-events: auto !important;
    touch-action: manipulation !important;
    cursor: pointer !important;
    background: transparent !important;
    border: none !important;
  }
  
  .mobile-nav-btn:active,
  .mobile-nav-btn.active {
    background: rgba(0, 224, 255, 0.1) !important;
    color: #00e0ff !important;
  }
  
  .mobile-nav-btn i {
    font-size: 1.3rem !important;
    pointer-events: none !important;
  }
  
  .mobile-nav-btn span {
    font-size: 0.7rem !important;
    font-weight: 500 !important;
    pointer-events: none !important;
  }

}

/* ============================================================================
   ACCESSIBILITY
   ============================================================================ */

@media (max-width: 1023px) {
  
  *:focus-visible {
    outline: 2px solid #00e0ff !important;
    outline-offset: 2px !important;
  }

}

/* ============================================================================
   SMALL SCREENS
   ============================================================================ */

@media (max-width: 375px) {
  
  #centered-search-container {
    width: calc(100% - 16px) !important;
  }
  
  #global-search {
    padding: 0 50px 0 40px !important;
  }
  
  #btn-refresh-network,
  #btn-logout-header {
    width: 40px !important;
    height: 40px !important;
  }

}

/* ============================================================================
   LANDSCAPE MODE
   ============================================================================ */

@media (max-width: 1023px) and (orientation: landscape) {
  
  #centered-search-container {
    bottom: calc(var(--safe-bottom) + 12px) !important;
  }

}

/* ============================================================================
   PERFORMANCE
   ============================================================================ */

@media (max-width: 1023px) {
  
  * {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  .scrollable,
  [style*="overflow"] {
    -webkit-overflow-scrolling: touch !important;
    overscroll-behavior: contain !important;
  }

}
